<!doctype html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0px; padding: 0px }
  #map_canvas { height: 100% }
</style>
<script type="text/javascript"
    src="http://maps.google.com/maps/api/js?sensor=false">
</script>
<script type="text/javascript">
function initialize() {
    var latlng = new google.maps.LatLng({{ county.geom.centroid.y }}, 
        {{ county.geom.centroid.x }});
    var myOptions = {
        zoom: {{ zoom }},
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var map = new google.maps.Map(document.getElementById("map_canvas"), 
        myOptions);
        
{% for zip in zips %}
    
    var polygon_{{ zip.code }};
    
    var coords_{{ zip.code }} = {{ zip.big_area_gpoly }};
    
    polygon_{{ zip.code }} = new google.maps.Polygon({
        paths: coords_{{ zip.code }},
        strokeColor: "{% cycle '#00FF00' '#0000FF' '#FF0000' '#FF00FF' '#00FFFF' '#FFFF00' %}",
        strokeOpacity: 0.8,
        strokeWeight: 1,
        fillColor: "{% cycle '#00FF00' '#0000FF' '#FF0000' '#FF00FF' '#00FFFF' '#FFFF00' %}",
        fillOpacity: 0.20
    });
    
    polygon_{{ zip.code }}.setMap(map);
    
    var infowindow_{{ zip.code }} = new google.maps.InfoWindow({
        content: '{{ zip.code }}'
    });
    
    var marker_{{ zip.code }} = new google.maps.Marker({
        position: new google.maps.LatLng({{ zip.coordinate.latitude}}, 
        {{ zip.coordinate.longitude }}),
        map: map,
        title: '{{ zip.code }}'
    });
    
    google.maps.event.addListener(marker_{{ zip.code }}, 'click', function() {
        infowindow_{{ zip.code }}.open(map,marker_{{ zip.code }});
    });
    google.maps.event.addListener(polygon_{{ zip.code }}, 'click', function() {
        infowindow_{{ zip.code }}.open(map,marker_{{ zip.code }});
    });
    google.maps.event.addListener(polygon_{{ zip.code }}, 'mouseover', function() {
         polygon_{{ zip.code }}.setOptions({
               fillOpacity: 0.75,
               }); 
    });
    google.maps.event.addListener(polygon_{{ zip.code }}, 'mouseout', function() {
         polygon_{{ zip.code }}.setOptions({
               fillOpacity: 0.20,
               }); 
    });
    
{% endfor %}
};

</script>
<style>
    body {
        font-family: sans-serif;
    }
    #map_canvas {
        width: 100%;
        height: 600px;
    }
    #zips {
        overflow: auto;
        width: 500px;
        height: 200px;
    }
    .linkOFF {color: darkblue}
    .linkON {color: white; background-color: darkblue}

</style>
</head>
<body onload="initialize()">
    <div id="map_canvas"></div>
    <div id="counties">
    {{ current_site.name }}
    {{ county.name }}
    {% for zip in zips %}
        <div id="{{zip.code}}" class="zips linkOFF">
            <a href="javascript:polygon_{{zip.code}}.setOptions({fillOpacity: 0.75});">{{ zip.code }}</a> ({{ zip.coordinate.latitude }}, {{ zip.coordinate.longitude }})
        </div>
    {% endfor %}
    </div>
</body>
</html>
